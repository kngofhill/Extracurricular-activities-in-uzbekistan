<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Extracurriculars Uzbekistan</title>
  <script defer src="https://www.gstatic.com/firebasejs/10.3.1/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.3.1/firebase-auth-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.3.1/firebase-database-compat.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="max-w-3xl mx-auto p-4">
    <h1 class="text-3xl font-bold mb-4">Extracurriculars Uzbekistan</h1>

    <div id="auth-section" class="mb-6">
      <h2 class="text-xl font-semibold mb-2">Login or Register</h2>
      <input id="email" type="email" placeholder="Email" class="border p-2 w-full mb-2" />
      <input id="password" type="password" placeholder="Password" class="border p-2 w-full mb-2" />
      <div class="flex gap-2">
        <button onclick="register()" class="bg-green-500 text-white px-4 py-2 rounded">Register</button>
        <button onclick="login()" class="bg-blue-500 text-white px-4 py-2 rounded">Login</button>
      </div>
    </div>

    <div id="main-section" class="hidden">
      <button onclick="logout()" class="mb-4 bg-red-500 text-white px-4 py-2 rounded">Logout</button>

      <!-- Post Form -->
      <h2 class="text-xl font-semibold mb-2">Post a Project</h2>
      <input id="title" type="text" placeholder="Project Title" class="border p-2 w-full mb-2" />
      <select id="location" class="border p-2 w-full mb-2">
        <option value="">Select City</option>
        <option value="Tashkent">Tashkent</option>
        <option value="Andijan">Andijan</option>
        <option value="Namangan">Namangan</option>
        <option value="Fergana">Fergana</option>
        <option value="Bukhara">Bukhara</option>
        <option value="Samarkand">Samarkand</option>
        <option value="Nukus">Nukus</option>
        <option value="Navoi">Navoi</option>
        <option value="Jizzakh">Jizzakh</option>
        <option value="Khiva">Khiva</option>
        <option value="Termez">Termez</option>
        <option value="Kokand">Kokand</option>
      </select>
      <select id="type" class="border p-2 w-full mb-2">
        <option value="">Select EC Type</option>
        <option value="Volunteering">Volunteering</option>
        <option value="Research">Research</option>
        <option value="Competitions">Competitions</option>
        <option value="Courses">Courses</option>
        <option value="Workshops">Workshops</option>
      </select>
      <textarea id="description" placeholder="What is this project about?" class="border p-2 w-full mb-2"></textarea>
      <input id="contact" type="text" placeholder="Contact info (email, phone, Telegram)" class="border p-2 w-full mb-2" />
      <button onclick="postProject()" class="bg-purple-500 text-white px-4 py-2 rounded">Submit</button>

      <!-- Search Form -->
      <h2 class="mt-8 text-xl font-semibold mb-2">Search Projects</h2>
      <select id="search-location" class="border p-2 w-full mb-2">
        <option value="">Any Location</option>
        <option value="Tashkent">Tashkent</option>
        <option value="Andijan">Andijan</option>
        <option value="Namangan">Namangan</option>
        <option value="Fergana">Fergana</option>
        <option value="Bukhara">Bukhara</option>
        <option value="Samarkand">Samarkand</option>
        <option value="Nukus">Nukus</option>
        <option value="Navoi">Navoi</option>
        <option value="Jizzakh">Jizzakh</option>
        <option value="Khiva">Khiva</option>
        <option value="Termez">Termez</option>
        <option value="Kokand">Kokand</option>
      </select>
      <select id="search-type" class="border p-2 w-full mb-2">
        <option value="">Any Type</option>
        <option value="Volunteering">Volunteering</option>
        <option value="Research">Research</option>
        <option value="Competitions">Competitions</option>
        <option value="Courses">Courses</option>
        <option value="Workshops">Workshops</option>
      </select>
      <button onclick="searchProjects()" class="bg-yellow-500 text-white px-4 py-2 rounded">Search</button>

      <div id="results" class="mt-6"></div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD__OINWiM7cLVx0pGsT3kBbZxrjBm23c0",
      authDomain: "extracurricularsuzbekistan.firebaseapp.com",
      databaseURL: "https://extracurricularsuzbekistan-default-rtdb.firebaseio.com",
      projectId: "extracurricularsuzbekistan",
      storageBucket: "extracurricularsuzbekistan.appspot.com",
      messagingSenderId: "555521664728",
      appId: "1:555521664728:web:bf72cb8384be98ff7b99ad",
      measurementId: "G-Z53076ZBCJ"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    auth.onAuthStateChanged(user => {
      document.getElementById('main-section').classList.toggle('hidden', !user);
      document.getElementById('auth-section').classList.toggle('hidden', !!user);
    });

    function register() {
      const email = email.value;
      const pass = password.value;
      auth.createUserWithEmailAndPassword(email, pass).catch(alert);
    }

    function login() {
      const email = email.value;
      const pass = password.value;
      auth.signInWithEmailAndPassword(email, pass).catch(alert);
    }

    function logout() {
      auth.signOut();
    }

    function postProject() {
      const post = {
        title: title.value,
        location: location.value,
        type: type.value,
        description: description.value,
        contact: contact.value
      };
      db.ref('projects').push(post);
      alert('Posted!');
    }

    function searchProjects() {
      const loc = searchLocation.value;
      const typ = searchType.value;
      db.ref('projects').once('value', snap => {
        const results = document.getElementById('results');
        results.innerHTML = '';
        snap.forEach(child => {
          const data = child.val();
          if ((loc === '' || data.location === loc) && (typ === '' || data.type === typ)) {
            const el = document.createElement('div');
            el.className = 'border p-4 mb-2 bg-white rounded shadow';
            el.innerHTML = `<h3 class="font-bold">${data.title}</h3>
              <p><strong>Location:</strong> ${data.location}</p>
              <p><strong>Type:</strong> ${data.type}</p>
              <p><strong>Description:</strong> ${data.description}</p>
              <p><strong>Contact:</strong> ${data.contact}</p>`;
            results.appendChild(el);
          }
        });
      });
    }
  </script>
</body>
</html>

